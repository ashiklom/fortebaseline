---
title: "FoRTE baseline"
author:
  - Alexey N. Shiklomanov
  - Jeff Atkins
  - Ben Bond-Lamberty
  - Christopher M. Gough
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
    bookdown::html_document2:
      fig_caption: yes
      reference_docx: "../templates/template.docx" # Insert path for the DOCX file
bibliography: references.bib
csl: "../templates/ecology.csl" # Insert path for the bib-style
abstract: |
  Text of abstract
keywords: |
  keyword 1; keyword 2; keyword 3
highlights: |
  These are the highlights. 
---

```{r, setup, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  warning = FALSE,
  message = FALSE,
  echo = FALSE,
  comment = "#>"
  ## fig.path = "../figures/"
)

## library(fortebaseline) # Or use devtools::load_all('.', quiet = T) if your code is in script files, rather than as functions in the `/R` diretory
```

# Introduction

Earth's climate is changing, and its terrestrial ecosystems are likely to be affected (REF: IPCC).
Many of these ecosystems will be affected through persistent changes in their environment, for instance through elevated atmospheric CO~2~ concentrations and temperature, changing precipitation regimes (REF).
At the same time, climate change is likely change the frequency and severity of disturbances [@dale_2001_climate], and the impacts of these changes may be more acute.

<!-- Add something positive about each of these? Then, the section about models is more compelling. -->
In trying to anticipate future changes to terrestrial ecosystems, ecologists have four general techniques.
One approach is to look to the past to see how ecosystems responded to similar changes (REFs).
This is challenging for two reasons:
For one, we often have to look very far back to find similar climate changes, and the techniques we have for determining the state of ecosystems in the distant past have limited detail (REF).
More importantly, there are few (if any) times where the climate has changed as rapidly as it is now, and it is unclear whether slower changes in the past will trigger responses similar to the faster changes happening now (REF).
A second approach is space-for-time substitution, whereby we use existing climatic gradients through space (e.g. with latitude or elevation) to infer the corresponding changes through time (REF).
However, many processes that drive spatial variation in ecosystems play out over hundreds or thousands of years (e.g. evolution), far longer than policy-relevant timescales of years to decades and far slower than the current pace of climate change (REF).
A third approach is to conduct experimental manipulations, where individuals are subjected to controlled changes in environmental conditions [@medlyn_2015_using].
Because they are able to isolate specific changes by controlling for most other factors, experiments are very useful for testing mechanisms.
Unfortunately, resource constraints limit the spatial and temporal extent of experiments, and emerging evidence from (the relatively few) long-term experiments suggests that short-term results cannot always be extrapolated from longer-term results [@reich_2018_unexpected].

The fourth approach is to use computer models based on existing understanding of ecosystem function.
Models unconstrained by data are little more than thought experiments with limited value to decision-making.
However, models provide a useful tool for confronting hypotheses with observations from a variety of sources, including the three described above [@dietze_2013_improving].

Model design involves an invariable trade-off between complexity and predictive uncertainty.
The more processes are represented in a model (and the more parameters are used to represent those processes), the higher the uncertainty in the "true" value of each parameter, and the higher the uncertainty in model predictions (especially out of sample) (REF -- information theory, e.g. AIC?).
On the other hand, simplistic models often fail to match important properties of the observations.
A key challenge in model development is to find the balance between these two extremes.


Big leaf models (e.g. CLM) fail to capture vegetation dynamics (REF).
This is due to their inability to represent demographic processes, which are important (REF).
An emerging class of models can simulate vegetation demographic processes, including competition for resources within a patch, recruitment, and mortality [@fisher_2017_vegetation].
Individually-based models are one possibility (REFs -- Shugart, Ensheng Wang, etc.).
However, they are complicated (REF).
An alternative are models of intermediate complexity ("middle ground"), which use approximations.
One such approximation is the "Ecosystem Demography" approach, whereby groups of individuals ("cohorts") of similar species, size, and structure are modeled together, and the statistical properties of these cohorts are modeled rather than the characteristics of each individual [@moorcroft_2001_method].

One realization of this is the Ecosystem Demography (v2) model [@moorcroft_2001_method; @medvigy_2011_predicting; @medvigy_2009_mechanistic].
This model has been used to simulate (examples...).


Net ecosystem productivity (NEP) declines immediately after disturbance, but recovers in 10-20 years [@amiro_2010_ecosystem].
Extent of recovery depends on balance of gross (aboveground?) primary productivity (GPP) and respiration; GPP increase during recovery, while respiration may stay constant [@amiro_2010_ecosystem].

<!--
TODO: Also discuss the other ED modules.
-->

This manuscript addresses the following research questions:
(Q1) To what extent can the ED2 model reproduce 100 years of observed succession (or observed _anything_) at UMBS starting from bare ground?
(Q2) How does the inclusion of various processes affect the accuracy and predictive uncertainty of ED2 predictions?
(Q3) What drives the predictive uncertainty of the ED2 model at UMBS, and what additional observations are necessary to improve predictions / constrain uncertainty?

Based on previous results [@fisher_2015_taking], we predict ED2 will over-predict dominance of early-successional canopy species (and under-predict understory productivity) under its default configuration.
Enabling dynamic N cycling and a finite canopy radius model will alleviate these issues, but will significantly increase the parameteric uncertainty due to strong sensitivity to N-cycling and canopy gap fraction parameters, respectively.
Constraining these parameters should be a high priority 

### Additional references

@katul_2003_relationship

# Methods

## Site description

- Secondary successional forest -- bigtooth aspen (_Populus grandidentata_), northern red oak (_Quercus rubra_), red maple (/Acer rubrum/), paper birch (_Betula papyrifera_), eastern white pine (_Pinus strobus_)
- Average age -- 95 years (2013)
- NEP in UMBS tower is 1.58 MG C ha-1 yr-1 (0.80-1.98) (1999-2006), but with landscape variation (REF?)
- Heavily logged in late 1800s and early 1900s, disturbed by fire until 1923
- Present day composition typical of upper Great Lakes region
- Previously, the site of the FASET experiment [@gough_2013_sustained; @gough_2008_multi]

## Model description: ED2

The Ecosystem Demography Model, version 2 (ED2) [@medvigy_2009_mechanistic].

Summary of common features (can move into supplement if necessary):

- Cohort-based scaling approach
- Photosynthesis / stomatal conductance
- Allometries

In this study, we run a factorial experiment of ED2 with the following features enabled or disabled:

- Radiative transfer
  - Two-stream model
    - Same general approach as in CLM 4.5 [@clm45_note], but rather than solving for just two layers (sunlit and shaded), solve for each canopy layer.
    - Set up the two-stream equations for each layer as a linear system and solve the entire set of equations numerically
    - Similar to approaches used in other models: JULES [@mercado_2007_improving], ORCHIDEE-CAN [@naudts_2015_vertically], CLM(SPA) [@bonan_2014_modeling]
  - Multiple scatter model **TODO**

# Results

```{r, include = FALSE}
lai_10yr_cap <- paste(
  "ED2 leaf area index (LAI) predictions by plant functional type."
)
```

```{r lai_10yr, fig.cap = lai_10yr_cap, fig.dim = c(10, 7)}
readd(results_plot)
```

# Discussion

# Conclusion

# Acknowledgements

<!-- The following line inserts a page break when the output is MS Word. For page breaks in PDF, use \newpage on its own line.  -->
##### pagebreak

# References 
<!-- The following line ensures the references appear here for the MS Word or HTML output files, rather than right at the end of the document (this will not work for PDF files):  -->
<div id="refs"></div>

##### pagebreak

### Colophon

This report was generated on `r Sys.time()` using the following computational environment and dependencies: 

```{r colophon, cache = FALSE}
# which R packages and versions?
devtools::session_info()
```

The current Git commit details are:

```{r}
# what commit is this file at? You may need to change the path value
# if your Rmd is not in analysis/paper/
git2r::repository("../..")
```
